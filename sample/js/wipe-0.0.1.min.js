/*!wipe-Zsp 0.0.1 发布日期:2018-11-12*/
var moveX,moveY,canvas=document.getElementById("cas"),context=canvas.getContext("2d"),_w=cas.width,_h=cas.height,raduis=20,isMouseDown=!1;function drawMask(e){e.fillStyle="rgba(122,122,122,1)",e.fillRect(0,0,375,667),e.globalCompositeOperation="destination-out"}function drawPoint(e,n,t){e.save(),e.beginPath(),e.arc(n,t,raduis,0,2*Math.PI),e.strokeStyle="red",e.fill(),e.restore()}function drawLine(e,n,t,o,a){e.save(),e.beginPath(),e.lineWidth=2*raduis,e.moveTo(n,t),e.lineTo(o,a),e.stroke(),e.restore()}function fn1(e){if(isMouseDown){var n=e||window.event;x2=n.clientX,y2=n.clientY,drawLine(context,moveX,moveY,x2,y2),moveX=x2,moveY=y2}}function getTransparencyPercent(e){for(var n=0,t=e.getImageData(0,0,_w,_h),o=0;o<_h;o++)for(var a=0;a<_w;a++){var i=4*(_w*o+a)+3;0==t.data[i]&&n++}isMouseDown=!1;var c=n/(_w*_h)*100;console.log((n/(_w*_h)*100).toFixed(2)+"%"),50<c&&clearRect(e)}function clearRect(e){e.clearRect(0,0,_w,_h)}cas.addEventListener("mousedown",function(e){isMouseDown=!0;var n=e||window.event;moveX=n.clientX,moveY=n.clientY,drawPoint(context,moveX,moveY)},!1),cas.addEventListener("mousemove",fn1,!1),cas.addEventListener("mouseup",function(){getTransparencyPercent(context)},!1),window.onload=function(){drawMask(context)};