/*!wipe-Zsp 0.0.1 发布日期:2018-11-13*/
var moveX,moveY,canvas=document.getElementById("cas"),context=canvas.getContext("2d"),_w=cas.width,_h=cas.height,raduis=20,isMouseDown=!1,device=/android|webos|iPhone|ipad|ipod|blackberry|iemobile|opera mini/i.test(navigator.userAgent.toLowerCase());console.log(navigator.userAgent),console.log(device);var clickEvtName=device?"touchstart":"mousedown",moveEvtName=device?"touchmove":"mousemove",endEvtName=device?"touchend":"mouseup";function drawMask(e){e.fillStyle="rgba(122,122,122,1)",e.fillRect(0,0,375,667),e.globalCompositeOperation="destination-out"}function drawhe(e,t,o,n,a){if(console.log("传递的实参个数"+arguments.length),3===arguments.length)e.save(),e.beginPath(),e.arc(t,o,raduis,0,2*Math.PI),e.strokeStyle="red",e.fill(),e.restore();else{if(5!==arguments.length)return!1;e.save(),e.lineCap="round",e.lineWidth=2*raduis,e.beginPath(),e.moveTo(t,o),e.lineTo(n,a),e.stroke(),e.restore()}}function getTransparencyPercent(e){for(var t=0,o=e.getImageData(0,0,_w,_h),n=0;n<_h;n++)for(var a=0;a<_w;a++){var i=4*(_w*n+a)+3;0==o.data[i]&&t++}isMouseDown=!1;var c=t/(_w*_h)*100;console.log((t/(_w*_h)*100).toFixed(2)+"%"),50<c&&clearRect(e)}function clearRect(e){e.clearRect(0,0,_w,_h)}cas.addEventListener(clickEvtName,function(e){isMouseDown=!0;var t=e||window.event;moveX=device?t.touches[0].clientX:t.clientX,moveY=device?t.touches[0].clientY:t.clientY,drawhe(context,moveX,moveY)},!1),cas.addEventListener(moveEvtName,function(e){if(!isMouseDown)return!1;var t=e||window.event;t.preventDefault(),x2=device?t.touches[0].clientX:t.clientX,y2=device?t.touches[0].clientY:t.clientY,drawhe(context,moveX,moveY,x2,y2),moveX=x2,moveY=y2},!1),cas.addEventListener(endEvtName,function(e){getTransparencyPercent(context)},!1),window.onload=function(){drawMask(context)};